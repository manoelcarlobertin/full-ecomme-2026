<article id="<%= dom_id product %>" class="group relative flex flex-col h-full bg-white/5 dark:bg-zinc-800/40 backdrop-blur-sm border border-zinc-200 dark:border-zinc-700/50 rounded-2xl overflow-hidden transition-all duration-300 hover:shadow-xl hover:shadow-blue-500/10 hover:-translate-y-1">
  <div class="group relative">
    <div class="aspect-h-1 aspect-w-1 w-full overflow-hidden rounded-md bg-gray-200 lg:aspect-none lg:h-80 relative">

      <% if product.image.attached? %>
          <%= image_tag product.image, 
                              loading: "lazy",
                              alt: product.name,
                              class: "h-full w-full object-cover object-center lg:h-full lg:w-full" %>
      <% else %>
        <div class="h-full w-full flex items-center justify-center bg-gray-100 text-gray-400">Sem Foto</div>
        <div class="absolute inset-0 flex items-center justify-center text-gray-300">
          <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
        </div>
      <% end %>

      <div class="absolute top-2 right-2 z-10">
        <% if user_signed_in? %>
          <%= render "products/favorite_button", product: product %>
        <% end %>
      </div>

    </div>

    <div class="mt-4 flex justify-between">
    </div>
  </div>


  <div class="absolute top-3 left-3 flex flex-wrap gap-2">
    <% product.categories.take(1).each do |cat| %>
      <span class="px-2.5 py-1 text-xs font-semibold tracking-wide text-white bg-black/60 backdrop-blur-md rounded-full border border-white/10">
        <%= cat.name %>
      </span>
    <% end %>
  </div>


  <div class="flex flex-col flex-1 p-5">
    <h3 class="text-lg font-bold text-zinc-800 dark:text-zinc-100 line-clamp-1" title="<%= product.name %>">
      <%= product.name %>
    </h3>

    <div class="mt-auto pt-4 flex items-center justify-between gap-4">
      <div class="flex flex-col">
        <span class="text-xs text-zinc-500 dark:text-zinc-400 font-medium">Pre√ßo</span>
        <span class="text-xl font-extrabold text-blue-600 dark:text-blue-400">
          <%= number_to_currency(product.price, unit: "R$ ", separator: ",", delimiter: ".") %>
        </span>
      </div>

      <%= button_to add_to_cart_path(product_id: product.id), 
          method: :post, 
          class: "relative inline-flex items-center justify-center p-3 text-sm font-medium text-white transition-all duration-200 bg-blue-600 rounded-xl hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-zinc-900 group-hover:shadow-lg group-hover:shadow-blue-500/30",
          aria: { label: "Adicionar #{product.name} ao carrinho" } do %>

            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
          <% end %>
    </div>
  </div>
</article>